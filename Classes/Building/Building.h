#pragma once
#ifndef __BUILDING_H__
#define __BUILDING_H__

#include <string>
#include <utility>
#include "cocos2d.h"
#include "../Combat/Combat.h"

/*
Building?? - ???????ßﬂ??????????????
*/
class Building : public cocos2d::Sprite {
protected:
    std::string name_;                // ????????
    int level_;                       // ???????
    int health_;                      // ????????
    int defense_;                     // ?????
    int buildtime_;                   // ?????????
    int buildcost_;                   // ??????
    std::pair<int, int> position_;    // ??????¶À????? (x, y)

public:
    // ???????????????????????????????????????????????????????¶À??
    Building(std::string name, int level, int health, int defense,
        int buildtime, int build_cost, std::pair<int, int> position);

    // ?¸D?????????????????????????????????????»Œ????????????????????????
    virtual void Upgrade();

    // ??????????????????
    void TakeDamage(int damage);

    // ??????????????????????
    void Repair();

    // ??˝n????????1???????0?????ßµ?
    bool IsDamaged() const;

    // ?¸D??????????????????????????????????????
    virtual void ShowInfo() const;

    // ???????????????????????????Å£??
    int GetMaxHealth() const;

    // ?????????????????????????????
    virtual ~Building() = default;

    // Getter??????????????????????????
    const std::string& GetName() const;
    int GetLevel() const;
    int GetHealth() const;
    int GetDefense() const;
    int GetBuildTime() const;
    int GetBuildCost() const;
    std::pair<int, int> GetPosition() const;
};

/*
SourceBuilding?? - ?????Building???????????????
*/
class SourceBuilding : public Building{
private:
    int production_rate_;  // ?ß≥?????????????

public:
    // ??????????????????????????¶À??????????????????
    SourceBuilding(int level, std::pair<int, int> position);

    // ?¸D???????????
    virtual int ProduceResource();

    // override?¸D?????????????????
    virtual void ShowInfo() const override;
};

/*
AttackBuilding?? - ?????Building??????????????
*/
class AttackBuilding : public Building {
private:
    int Range_;  // ??????¶∂

public:
    // ?????????????????????????¶À??????®¥?????¶∂
    AttackBuilding(int level, std::pair<int, int> position);

    // ?¸D??????ß€???
    void Attack(Soilder& target);

    // override?¸D????????????????
    virtual void ShowInfo() const override;
};

#endif // __BUILDING_H__